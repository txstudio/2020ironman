03-SSMS-很好用但還是要多撰寫-Transact-SQL
2020ironman-day03-write-transact-sql-even-ssms-is-a-great-gui-tool.html

<p>雖然微軟為 SQL Server 開發很好用的 GUI 圖形介面 SQL Server Management Studio<br/>
但還是要有撰寫 Transact-SQL 指令碼的能力</p>

<p>例：使用下列指定建立新資料表</p>

<pre><code>CREATE TABLE Production.Product 
(
    ... 
)
</code></pre>

<h2>舉兩個會因使用 Transact-SQL 變得更方便的情境</h2>

<h3>情境 1</h3>

<p>今天要變更一張資料表主索引鍵的資料型態<br/>
要執行的步驟如下</p>

<ul>
<li>移除相依資料表的所有外來鍵參考</li>
<li>移除資料表的主索引鍵</li>
<li>修改外來鍵參考欄位與主索引鍵欄位的資料型態</li>
<li>重新加入主索引鍵</li>
<li>加入原本相依資料表的外來鍵參考</li>
</ul>

<p>若透過圖形介面操作上述複雜步驟<br/>
謹慎的你或許會</p>

<ul>
<li><strong>先在測試環境先操作過一次</strong></li>
<li><strong>再到正式環境操作一次</strong></li>
</ul>

<p>若撰寫成 Transact-SQL 語法<br/>
僅需要將測試環境執行成功的指令碼<br/>
複製到正式環境再執行一次即可</p>

<h3>情境 2</h3>

<p>於離峰時間進行歷程資料搬移作業<br/>
譬如將超過三個月的訂單資料搬移到歷程記錄資料表<br/>
為確保交易紀錄檔不會爆衝，會先進行下列步驟</p>

<ul>
<li>調整資料庫的復原模式為「交易紀錄」</li>
<li>將超過三個月的資料複製到歷程資料表</li>
<li>重新變更復原模式為「完整」</li>
</ul>

<p>這種離峰作業不會每天手動進行<br/>
將操作指令撰寫成 Transact-SQL 指令碼<br/>
透過 SQL Agent 或是其他排程工具進行<br/>
執行穩定之後就只要持續追蹤即可</p>

<p>多熟悉指令碼，在轉換開發/管理工具，或是當時無法使用熟悉工具時也能夠快速上手<br/>
開發/管理工具只是輔助</p>

<p>標準的 SQL 語法在不同資料庫之間也是可以通用</p>