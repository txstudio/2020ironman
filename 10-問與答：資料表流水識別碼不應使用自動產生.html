10-問與答：資料表流水識別碼不應使用自動產生
2020ironman-day10-qa-do-not-use-identity-for-int-type-primary-key.html

<h2>論點</h2>

<p>若使用 IDENTITY 等資料庫自動產生的方式給予識別碼<br/>
當資料列被刪除時，序號就會產生截斷<br/>
所以主索引鍵序號的值應從應用程式產生</p>

<p>例：</p>

<pre><code>1    訂單#1
2    訂單#2
3     訂單#3
</code></pre>

<p>若今天刪除「訂單#3」然後再新增一筆訂單就會變成</p>

<pre><code>1    訂單#1
2    訂單#2
4     訂單#4
</code></pre>

<p>應該是</p>

<pre><code>1    訂單#1
2    訂單#2
3     訂單#4
</code></pre>

<h2>答</h2>

<p>這是一個很有趣的論點<br/>
上述情境中編號 3 的訂單不見是件「<strong>非常合理</strong>」的事情</p>

<p>大部分取得訂單會使用流水識別碼<br/>
若今天 3 被刪掉然後又新增一筆 3 出來</p>

<p>使用者就會發現：<br/>
今天我編號 3 的訂單怎麼跟之前不一樣了（因為顯示為訂單#4）</p>

<p>若使用應用程式來管理序號<br/>
就需要注意在水平擴充調整規模時會不會產生衝突</p>

<p>所以遞增序號應該由 SQL Server 負責提供<br/>
無論是使用「序列 (<strong>Sequence</strong>)」或是 <strong>IDENTITY</strong> 皆可<br/>
可以更加確保資料的一致性</p>