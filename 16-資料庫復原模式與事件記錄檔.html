16-資料庫復原模式與事件記錄檔
2020ironman-day16-recovery-mode-and-log.html

<p>在 SQL Server 中<br/>
復原模式有三種：<strong>完整</strong>、<strong>大量紀錄</strong>與<strong>簡單模式</strong></p>

<h2>淺談復原模式</h2>

<h3>完整 (Full)</h3>

<p>完整復原模式可使用完整、差異與事件紀錄備份<br/>
在此模式下的資料庫異動紀錄是逐筆進行</p>

<p>可透過事件紀錄還原將資料庫復原到指定的時間點</p>

<h3>大量紀錄 (Bulk-logged)</h3>

<p>此模式下資料庫的異動不會逐筆記錄到交易紀錄 (*.ldf) 檔中<br/>
會改以批次進行紀錄</p>

<p>相較於完整復原模式<br/>
產生的交易紀錄資料相較之下會比較小<br/>
速度也相較之下比較快</p>

<p>在離峰時機進行批次異動時</p>

<blockquote>如：索引重組、資料封存</blockquote>

<p>就可將資料庫的復原模式切換至「大量紀錄」<br/>
執行完成後再切換至「完整」復原模式</p>

<p>在尖峰時間持續提供線上交易存取</p>

<h3>簡單 (Simple)</h3>

<p>此復原模式僅支援完整備份<br/>
資料庫設定此復原模式時就不會有交易紀錄 (*.ldf) 產生</p>

<p>像是儲存紀錄使用的資料庫就可考慮設定成簡單復原模式</p>

<blockquote>僅會有 INSERT 資料的情況產生</blockquote>

<h2>截斷事件紀錄檔案</h2>

<p>一個設定為完整復原的資料庫<br/>
若沒有定期進行「完整備份」或「大量紀錄」<br/>
事件記錄檔案就會不停增加</p>

<p>最後會演變成<br/>
交易記錄檔的大小會比資料庫檔案還要大</p>

<p>SQL Server Express 僅支援「簡單 Simple」模式</p>